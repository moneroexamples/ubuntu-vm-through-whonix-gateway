<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Monero Examples by moneroexamples</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Monero Examples</h1>
      <h2 class="project-tagline">xubuntu-vm-through-whonix-gateway</h2>
      <a href="https://github.com/moneroexamples/xubuntu-vm-through-whonix-gateway" class="btn">View on GitHub</a>
      <a href="https://github.com/moneroexamples/xubuntu-vm-through-whonix-gateway/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/moneroexamples/xubuntu-vm-through-whonix-gateway/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="how-to-set-xubuntu-vm-to-use-tor-whonix-gateway" class="anchor" href="#how-to-set-xubuntu-vm-to-use-tor-whonix-gateway" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to set Xubuntu VM to use TOR Whonix gateway</h1>

<p>Default <a href="https://www.whonix.org/">whonix</a> workstation is
based on 32-bit Debian 8.2. This is OK for most cases, since this
Debian version is from 2015. However, the 32-bit version
of Debian may limit some use cases. For example, its difficult to use <a href="https://getmonero.org/">Monero</a> on a 32-bit Linux system. Monero works best with 64-bit operating systems. Also some people may not want to use Debian, and would like to use something else, such as Xubuntu 15.10 x64.</p>

<p>This example shows how to set-up Xubuntu 15.10 x64 in a VirtualBox so that its internet traffic goes through Whonix Tor gateway.</p>

<p><strong>Please be aware, that not using official
Whonix workstation may reduce your security and anonymity!</strong></p>

<p>The steps here were executed on Ubuntu 14.04 x64 and VirtualBox 5.0.10, and are based on those described <a href="https://www.whonix.org/wiki/Ubuntu">here</a>. Probably there are better ways of doing things described below. But these steps were working for me, so hopefully they will work for you as well.</p>

<h2>
<a id="step-1-download-whonix-gateway-vritualbox-and-xubuntu-images" class="anchor" href="#step-1-download-whonix-gateway-vritualbox-and-xubuntu-images" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Download Whonix Gateway VritualBox and Xubuntu images</h2>

<p>For Whonix, go to the Whonix <a href="https://www.whonix.org/wiki/Download">download website</a>
and download the latest gateway image. At the moment of writing this, it is called <code>Whonix-Gateway-12.0.0.3.2.ova</code>.</p>

<p>For Xubuntu, download <code>xubuntu-15.10-desktop-amd64.iso</code> from Xubuntu's <a href="http://xubuntu.org/getxubuntu/">download
 page</a>.</p>

<p>## Step 2: Import Whonix workstation into VirtualBox.</p>

<ul>
<li>In VirtualBox Manager: <code>File-&gt;Import Appliance</code>.</li>
<li>Locate the <code>Whonix-Gateway-12.0.0.3.2.ova</code> downloaded.</li>
<li>Follow the prompts to import the image.</li>
</ul>

<h2>
<a id="step-2-install-xubuntu-in-the-virtualbox" class="anchor" href="#step-2-install-xubuntu-in-the-virtualbox" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: Install Xubuntu in the VirtualBox</h2>

<ul>
<li>
<code>Machine-&gt;New</code> and follow the prompts. I recommend at least 2GB of RAM and at least 25 GB of disc space if you plan to use latest Monero in the VirtualBox.<br>
</li>
<li>Install Xubuntu as you would normally do it. In this example, I called it u1555.</li>
<li>Install any software you need now (e.g.,stuff needed to compile latest Monero, vim, etc.),
before connecting the Xubuntu to the Whonix gateway. Its much faster now, than updating
and install everything through tor.</li>
<li>You can also install guest additions if you want, to make the interacting with the Xubuntu VM easier.</li>
</ul>

<h2>
<a id="step-3-change-xubuntus-network-to-use-whonix-network" class="anchor" href="#step-3-change-xubuntus-network-to-use-whonix-network" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3: Change Xubuntu's network to use Whonix network</h2>

<ul>
<li>
<code>Machine-&gt;Settings-&gt;Network</code> and change Adapter 1 from NAT into Internal Network.</li>
<li>Make sure that the Name is <code>Whonix</code>.</li>
</ul>

<p><img src="https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/network_setup.jpg" alt="Network setup"></p>

<h2>
<a id="step-4-remove-dhcp-auto-configuraion-packages-from-xubuntu" class="anchor" href="#step-4-remove-dhcp-auto-configuraion-packages-from-xubuntu" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 4: Remove dhcp auto-configuraion packages from Xubuntu</h2>

<p>You can make VirtualBox snapshot here, just in case something does not work later on,
and you would like to undo the changes.</p>

<div class="highlight highlight-source-shell"><pre>sudo apt-get remove isc-dhcp-client isc-dhcp-common network-manager network-manager-gnome resolvconf</pre></div>

<h2>
<a id="step-5-check-the-whonix-gateway-ip-and-network-subnet" class="anchor" href="#step-5-check-the-whonix-gateway-ip-and-network-subnet" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 5: Check the Whonix Gateway IP and network subnet</h2>

<p>Start the Whonix Gateway and follow the prompts. Once done, check the gateway IP address and network mask.
I used the following command:</p>

<div class="highlight highlight-source-shell"><pre>cat /etc/network/interfaces.d/30_non-qubes-whonix</pre></div>

<p><img src="https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/gateway_ip.jpg" alt="Gateway IP address"></p>

<p>From the output, we can see that the Whonix Gateway IP is <code>10.152.152.10</code> and network mask is <code>255.255.192.0</code>.</p>

<h2>
<a id="step-6-check-the-name-of-network-interface-in-xubuntu" class="anchor" href="#step-6-check-the-name-of-network-interface-in-xubuntu" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 6: Check the name of network interface in Xubuntu</h2>

<div class="highlight highlight-source-shell"><pre>ifconfig -a</pre></div>

<p>Gives (part of the output shown):</p>

<div class="highlight highlight-source-shell"><pre>enp0s3    Link encap:Ethernet  HWaddr 08:00:27:73:b5:e3  
          BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</pre></div>

<p>So the interface name is <code>enp0s3</code>.</p>

<h2>
<a id="step-7-make-enp0s3-use-whonix-gateway" class="anchor" href="#step-7-make-enp0s3-use-whonix-gateway" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 7: Make enp0s3 use Whonix gateway</h2>

<p>Need to set static IP for Xubuntu to use Whonix network. Thus, we need IP of the form <code>10.152.152.xx</code> where xx is more than 10. For example <code>10.152.152.15</code>.</p>

<div class="highlight highlight-source-shell"><pre>sudo nano /etc/network/interfaces</pre></div>

<p>add the following to the end:</p>

<div class="highlight highlight-source-shell"><pre>auto enp0s3
iface enp0s3 inet static
       <span class="pl-c">## Increment last octet of address</span>
       <span class="pl-c">## on optional additional workstations.</span>

<span class="pl-c"># Xubuntu static IP</span>
address 10.152.152.15  

<span class="pl-c"># Whonix Network mask</span>
netmask 255.255.192.0  

<span class="pl-c"># Whonix gateway IP</span>
gateway 10.152.152.10  </pre></div>

<p>Also, a name server needs to be specified.</p>

<div class="highlight highlight-source-shell"><pre>sudo nano /etc/resolv.conf</pre></div>

<p>and add:</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c"># Whonix gateway IP.</span>
nameserver 10.152.152.10</pre></div>

<h2>
<a id="step-8-restart-xubuntu" class="anchor" href="#step-8-restart-xubuntu" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 8: Restart Xubuntu</h2>

<p>Make sure Whonix Gateway is working and restart the Xubuntu. After that, Xubuntu should use the Whonix Gateway for all internet traffic.</p>

<p>And now everything should be OK. You can start <code>firefox</code> and check your IP address at <a href="https://check.torproject.org/">tor check website</a> or in a terminal using <code>elinks</code> or <code>lynx</code>.</p>

<p>For example:</p>

<div class="highlight highlight-source-shell"><pre>elinks https://check.torproject.org/</pre></div>

<p><img src="https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/tor_check.jpg" alt="Tor check"></p>

<h2>
<a id="monero-in-xubuntu-vm-through-whonix-gateway" class="anchor" href="#monero-in-xubuntu-vm-through-whonix-gateway" aria-hidden="true"><span class="octicon octicon-link"></span></a>Monero in Xubuntu VM through Whonix Gateway</h2>

<p>Because we use Xubuntu 64-bit there is no issues with running
latest Monero. How to compile it can be found at
<a href="http://moneroexamples.github.io/compile-monero-ubuntu-1510/">compile-monero-ubuntu-1510</a>.</p>

<p>The only problem is initial synchronization, as it will take ages
through tor. So better to download the current blockchain without tor before setting up the gateway or on other PC or VM that is not using Tor. Once the current blockchain is obtained it can be copied into Xubuntu VM.</p>

<p>Running the Monero node through tor does not take much bandwidth
nor is slow, as it is done in real-time as blocks are coming. The only slow thing is the initial synchronization as it requires downloading ~8GB or more of data. Also, it wont be full node, as other nodes will not be able to connect to you.</p>

<h2>
<a id="how-can-you-help" class="anchor" href="#how-can-you-help" aria-hidden="true"><span class="octicon octicon-link"></span></a>How can you help?</h2>

<p>Constructive criticism, code and website edits are always good. They can be made through github.</p>

<p>Some Monero are also welcome:</p>

<pre><code>48daf1rG3hE1Txapcsxh6WXNe9MLNKtu7W7tKTivtSoVLHErYzvdcpea2nSTgGkz66RFP4GKVAsTV14v6G3oddBTHfxP6tU
</code></pre>

<h2>
<a id="comments" class="anchor" href="#comments" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comments</h2>

<div id="disqus_thread"></div>



Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/moneroexamples/xubuntu-vm-through-whonix-gateway">Monero Examples</a> is maintained by <a href="https://github.com/moneroexamples">moneroexamples</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
