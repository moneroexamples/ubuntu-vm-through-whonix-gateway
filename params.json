{"name":"Monero Examples","tagline":"xubuntu-vm-through-whonix-gateway","body":"# How to set Xubuntu VM to use TOR Whonix gateway\r\n\r\nDefault [whonix](https://www.whonix.org/) workstation is\r\nbased on Debian 8.2 32 bit. This is OK for most cases, since this\r\nDebain version is from 2015.  However, the 32-bit version\r\nof Debian may limit some use cases. For example, its difficult to use\r\n[Monero](https://getmonero.org/) on a 32-bit Linux system. Monero works best\r\nwith 64-bit operating systems. Also some people may night be not\r\nbig fans of Debian, and would like to use something else, such as Ubuntu 15.10. However, for use in a VirtualBox,\r\nXubuntu is be better because xfce is much lighter than Unity.\r\n\r\nThis example shows how to set-up Xubuntu 15.10 x64 in a VirtualBox so that it\r\ngoes through Whonix Tor gateway.\r\n\r\n**Please be aware, that not using official\r\nWhonix workstation may reduce your security and anonymity!\r\nDon't follow this example if you are extra paranoid.**\r\n\r\nThe steps here were executed on Ubuntu 14.04 x64 and VirtualBox 5.0.10, and are based on those described [here](https://www.whonix.org/wiki/Ubuntu). Probably there are better ways of doing things described below. But these steps were working for me, so hopefully they will work for you as well.\r\n\r\n\r\n## Step 1: Download Whonix Gateway VritualBox and Xubuntu images\r\n\r\nFor Whonix, go to the Whonix [download website](https://www.whonix.org/wiki/Download)\r\nand download the latest workstation image. At the moment of writing this,\r\n it is `Whonix-Gateway-12.0.0.3.2.ova`.\r\n\r\n For Xubuntu, download `xubuntu-15.10-desktop-amd64.iso` from Xubuntu's [download\r\n page](http://xubuntu.org/getxubuntu/).\r\n\r\n\r\n ## Step 2: Import Whonix workstation to VirtualBox.\r\n\r\n  - In VirtualBox Manager: `File->Import Appliance`\r\n  - locate the `Whonix-Gateway-12.0.0.3.2.ova` downloaded\r\n  - follow the prompts to import the image.\r\n\r\n## Step 2: Install Xubuntu in the VirtualBox\r\n\r\n  - `Machine->New` and follow the prompts. I recommend at least 2GB of RAM and at least 25 GB of disc space, if you plan to use latest monero in\r\n     the VirtualBox.       \r\n  - Install Xubuntu as you would normally do it. In this example, I called it u1555.\r\n  - Install any software you need now (e.g.,stuff needed to compile latest monero, vim, etc.),\r\n   before connecting the Xubuntu to the Whonix gateway. Its much faster now, than updating\r\n   and install everything through tor.\r\n  - You can also install guest additions if you want, to make the interacting with the Xubuntu VM easier.\r\n\r\n\r\n## Step 3: Change Xubuntu's network to use Whonix network\r\n\r\n - `Machine->Settings->Network` and change Adapter 1 from NAT into Internal Network.\r\n - Make sure that the Name is `Whonix`.\r\n\r\n![Network setup](https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/network_setup.jpg)\r\n\r\n## Step 4: Remove dhcp auto-configuraion packages from Xubuntu\r\n\r\nYou can make VirtualBox snapshot here, just in case something does not work later on,\r\nand you would like to undo the changes.\r\n\r\n```bash\r\nsudo apt-get remove isc-dhcp-client isc-dhcp-common network-manager network-manager-gnome resolvconf\r\n```\r\n## Step 5: Check the Whonix Gateway IP and network subnet\r\n\r\nStart the Whonix Gateway and follow the prompts. Once done, check the gateway IP address and network mask.\r\nI used the following command:\r\n\r\n```bash\r\ncat /etc/network/interfaces.d/30_non-qubes-whonix\r\n```\r\n\r\n![Gateway IP address](https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/gateway_ip.jpg)\r\n\r\n\r\n## Step 6: Check the name of network interface in Xubuntu\r\n\r\n```bash\r\nifconfing -a\r\n```\r\n\r\nGives (part of the output shown)\r\n\r\n```bash\r\nenp0s3    Link encap:Ethernet  HWaddr 08:00:27:73:b5:e3  \r\n          BROADCAST MULTICAST  MTU:1500  Metric:1\r\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\r\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\r\n          collisions:0 txqueuelen:1000\r\n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\r\n```\r\n\r\nSo the interface name is `enp0s3`.\r\n\r\n\r\n## Step 7: Make enp0s3 use Whonix gateway\r\n\r\nNeed to set static IP for Xubuntu from Whonix network. Thus we need ip of the form\r\n`10.152.152.xx` where xx is more than 10. For example, `10.152.152.15`.\r\n\r\n```bash\r\nsudo nano /etc/network/interfaces\r\n```\r\n\r\nadd the following to the end:\r\n\r\n```bash\r\nauto enp0s3\r\niface enp0s3 inet static\r\n       ## Increment last octet of address\r\n       ## on optional additional workstations.\r\n\r\n# Xubuntu static IP\r\naddress 10.152.152.15  \r\n\r\n# Whonix Network mask\r\nnetmask 255.255.192.0  \r\n\r\n# Whonix gateway IP\r\ngateway 10.152.152.10  \r\n\r\n```\r\n\r\nAlso, a name server needs to be specified.\r\n\r\n```bash\r\nsudo nano /etc/resolv.conf\r\n```\r\n\r\nand add:\r\n\r\n```bash\r\n# Whonix gateway IP.\r\nnameserver 10.152.152.10\r\n```\r\n\r\n## Step 8: Restart Xubuntu\r\n\r\nMake sure Whonix Gateway is working and restart the Xubuntu. After that, Xubuntu should use\r\nthe Whonix Gateway for all internet trafic.\r\n\r\nAnd now everything should work. You can start `firefox` and check your ip address at [tor check website](https://check.torproject.org/) or in console using `elinks` or `lynx`.\r\n\r\nFor example:\r\n\r\n```bash\r\nelinks https://check.torproject.org/\r\n```\r\n\r\n![Tor check](https://raw.githubusercontent.com/moneroexamples/xubuntu-vm-through-whonix-gateway/master/img/tor_check.jpg)\r\n\r\n\r\n\r\n## Monero in Xubuntu VM through Whonix Gateway\r\n\r\nBecause we use Xubuntu 64-bit there is no issues with running\r\nlatest monero. How to compile it can be found at\r\n[compile-monero-ubuntu-1510](http://moneroexamples.github.io/compile-monero-ubuntu-1510/).\r\n\r\nThe only problem is initial synchronization, as it will take ages\r\nthrough tor. So better to download the current blockchain without tor before setting up the gateway or on other PC or VM that is not using Tor. Once the current\r\nblockchain is obtained it can be copied into Xubuntu VM.\r\n\r\nRunning the bitcoin node through tor does not take much bandwidth\r\nor is not slow, as it is done in real time as block are coming. The only slow thing is the initial synchronization at it requires downloading ~8GB or more of data.\r\n\r\n\r\n## How can you help?\r\n\r\nConstructive criticism, code and website edits are always good. They can be made through github.\r\n\r\nSome Monero are also welcome:\r\n```\r\n48daf1rG3hE1Txapcsxh6WXNe9MLNKtu7W7tKTivtSoVLHErYzvdcpea2nSTgGkz66RFP4GKVAsTV14v6G3oddBTHfxP6tU\r\n```    \r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}